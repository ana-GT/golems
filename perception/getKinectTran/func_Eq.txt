  t2 = sin(ra);
  t3 = sin(ya);
  t4 = cos(ra);
  t5 = cos(ya);
  t6 = sin(pa);
  t8 = cos(pa);
  t7 = tx-xr-yk*(t3*t4-t2*t5*t6)+zk*(t2*t3+t4*t5*t6)+t5*t8*xk;
  t9 = ty-yr+yk*(t4*t5+t2*t3*t6)-zk*(t2*t5-t3*t4*t6)+t3*t8*xk;
  t10 = tz-zr-t6*xk+t2*t8*yk+t4*t8*zk;
  t0 = t7*t7+t9*t9+t10*t10;
